INFO 02-24 11:26:56 __init__.py:190] Automatically detected platform cuda.
INFO 02-24 11:26:58 api_server.py:840] vLLM API server version 0.7.2
INFO 02-24 11:26:58 api_server.py:841] args: Namespace(subparser='serve', model_tag='/scratch/gpfs/jx0800/models/Llama-3.2-1B-Instruct', config='', host=None, port=11434, uvicorn_log_level='info', allow_credentials=False, allowed_origins=['*'], allowed_methods=['*'], allowed_headers=['*'], api_key=None, lora_modules=None, prompt_adapters=None, chat_template=None, chat_template_content_format='auto', response_role='assistant', ssl_keyfile=None, ssl_certfile=None, ssl_ca_certs=None, ssl_cert_reqs=0, root_path=None, middleware=[], return_tokens_as_token_ids=False, disable_frontend_multiprocessing=False, enable_request_id_headers=False, enable_auto_tool_choice=False, enable_reasoning=False, reasoning_parser=None, tool_call_parser=None, tool_parser_plugin='', model='/scratch/gpfs/jx0800/models/Llama-3.2-1B-Instruct', task='auto', tokenizer=None, skip_tokenizer_init=False, revision=None, code_revision=None, tokenizer_revision=None, tokenizer_mode='auto', trust_remote_code=False, allowed_local_media_path=None, download_dir=None, load_format='auto', config_format=<ConfigFormat.AUTO: 'auto'>, dtype='auto', kv_cache_dtype='auto', max_model_len=None, guided_decoding_backend='xgrammar', logits_processor_pattern=None, model_impl='auto', distributed_executor_backend=None, pipeline_parallel_size=1, tensor_parallel_size=1, max_parallel_loading_workers=None, ray_workers_use_nsight=False, block_size=None, enable_prefix_caching=None, disable_sliding_window=False, use_v2_block_manager=True, num_lookahead_slots=0, seed=0, swap_space=4, cpu_offload_gb=0, gpu_memory_utilization=0.9, num_gpu_blocks_override=None, max_num_batched_tokens=None, max_num_seqs=None, max_logprobs=20, disable_log_stats=False, quantization=None, rope_scaling=None, rope_theta=None, hf_overrides=None, enforce_eager=False, max_seq_len_to_capture=8192, disable_custom_all_reduce=False, tokenizer_pool_size=0, tokenizer_pool_type='ray', tokenizer_pool_extra_config=None, limit_mm_per_prompt=None, mm_processor_kwargs=None, disable_mm_preprocessor_cache=False, enable_lora=False, enable_lora_bias=False, max_loras=1, max_lora_rank=16, lora_extra_vocab_size=256, lora_dtype='auto', long_lora_scaling_factors=None, max_cpu_loras=None, fully_sharded_loras=False, enable_prompt_adapter=False, max_prompt_adapters=1, max_prompt_adapter_token=0, device='auto', num_scheduler_steps=1, multi_step_stream_outputs=True, scheduler_delay_factor=0.0, enable_chunked_prefill=None, speculative_model=None, speculative_model_quantization=None, num_speculative_tokens=None, speculative_disable_mqa_scorer=False, speculative_draft_tensor_parallel_size=None, speculative_max_model_len=None, speculative_disable_by_batch_size=None, ngram_prompt_lookup_max=None, ngram_prompt_lookup_min=None, spec_decoding_acceptance_method='rejection_sampler', typical_acceptance_sampler_posterior_threshold=None, typical_acceptance_sampler_posterior_alpha=None, disable_logprobs_during_spec_decoding=None, model_loader_extra_config=None, ignore_patterns=[], preemption_mode=None, served_model_name=None, qlora_adapter_name_or_path=None, otlp_traces_endpoint=None, collect_detailed_traces=None, disable_async_output_proc=False, scheduling_policy='fcfs', override_neuron_config=None, override_pooler_config=None, compilation_config=None, kv_transfer_config=None, worker_cls='auto', generation_config=None, override_generation_config={'temperature': 0.6, 'top_p': 0.95, 'top_k': 100, 'max_tokens': 2048}, enable_sleep_mode=False, calculate_kv_scales=False, disable_log_requests=False, max_log_len=None, disable_fastapi_docs=False, enable_prompt_tokens_details=False, dispatch_function=<function serve at 0x14c4b8fced40>)
INFO 02-24 11:26:58 api_server.py:206] Started engine process with PID 4175394
INFO 02-24 11:27:07 __init__.py:190] Automatically detected platform cuda.
INFO 02-24 11:27:15 config.py:542] This model supports multiple tasks: {'embed', 'classify', 'generate', 'reward', 'score'}. Defaulting to 'generate'.
WARNING 02-24 11:27:15 arg_utils.py:1135] Chunked prefill is enabled by default for models with max_model_len > 32K. Currently, chunked prefill might not work with some features or models. If you encounter any issues, please disable chunked prefill by setting --enable-chunked-prefill=False.
INFO 02-24 11:27:15 config.py:1556] Chunked prefill is enabled with max_num_batched_tokens=2048.
INFO 02-24 11:27:16 config.py:542] This model supports multiple tasks: {'reward', 'generate', 'embed', 'score', 'classify'}. Defaulting to 'generate'.
WARNING 02-24 11:27:16 arg_utils.py:1135] Chunked prefill is enabled by default for models with max_model_len > 32K. Currently, chunked prefill might not work with some features or models. If you encounter any issues, please disable chunked prefill by setting --enable-chunked-prefill=False.
INFO 02-24 11:27:16 config.py:1556] Chunked prefill is enabled with max_num_batched_tokens=2048.
INFO 02-24 11:27:16 llm_engine.py:234] Initializing a V0 LLM engine (v0.7.2) with config: model='/scratch/gpfs/jx0800/models/Llama-3.2-1B-Instruct', speculative_config=None, tokenizer='/scratch/gpfs/jx0800/models/Llama-3.2-1B-Instruct', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=131072, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='xgrammar'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=/scratch/gpfs/jx0800/models/Llama-3.2-1B-Instruct, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=True, use_async_output_proc=True, disable_mm_preprocessor_cache=False, mm_processor_kwargs=None, pooler_config=None, compilation_config={"splitting_ops":[],"compile_sizes":[],"cudagraph_capture_sizes":[256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"max_capture_size":256}, use_cached_outputs=True, 
/home/jx0800/.conda/envs/graphrag/lib/python3.11/site-packages/vllm/executor/uniproc_executor.py:29: UserWarning: Failed to get the IP address, using 0.0.0.0 by default.The value can be set by the environment variable VLLM_HOST_IP or HOST_IP.
  get_ip(), get_open_port())
INFO 02-24 11:27:17 cuda.py:230] Using Flash Attention backend.
INFO 02-24 11:27:18 model_runner.py:1110] Starting to load model /scratch/gpfs/jx0800/models/Llama-3.2-1B-Instruct...
Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.08s/it]
Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:03<00:00,  3.08s/it]

INFO 02-24 11:27:21 model_runner.py:1115] Loading model weights took 2.3185 GB
INFO 02-24 11:27:22 worker.py:267] Memory profiling takes 0.54 seconds
INFO 02-24 11:27:22 worker.py:267] the current vLLM instance can use total_gpu_memory (39.49GiB) x gpu_memory_utilization (0.90) = 35.55GiB
INFO 02-24 11:27:22 worker.py:267] model weights take 2.32GiB; non_torch_memory takes 0.09GiB; PyTorch activation peak memory takes 1.18GiB; the rest of the memory reserved for KV Cache is 31.96GiB.
INFO 02-24 11:27:22 executor_base.py:110] # CUDA blocks: 65444, # CPU blocks: 8192
INFO 02-24 11:27:22 executor_base.py:115] Maximum concurrency for 131072 tokens per request: 7.99x
INFO 02-24 11:27:27 model_runner.py:1434] Capturing cudagraphs for decoding. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI. If out-of-memory error occurs during cudagraph capture, consider decreasing `gpu_memory_utilization` or switching to eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|▎         | 1/35 [00:03<01:46,  3.12s/it]Capturing CUDA graph shapes:   6%|▌         | 2/35 [00:03<00:49,  1.49s/it]Capturing CUDA graph shapes:   9%|▊         | 3/35 [00:03<00:30,  1.03it/s]Capturing CUDA graph shapes:  11%|█▏        | 4/35 [00:04<00:22,  1.38it/s]Capturing CUDA graph shapes:  14%|█▍        | 5/35 [00:04<00:17,  1.70it/s]Capturing CUDA graph shapes:  17%|█▋        | 6/35 [00:04<00:14,  1.98it/s]Capturing CUDA graph shapes:  20%|██        | 7/35 [00:05<00:12,  2.21it/s]Capturing CUDA graph shapes:  23%|██▎       | 8/35 [00:05<00:11,  2.39it/s]Capturing CUDA graph shapes:  26%|██▌       | 9/35 [00:05<00:10,  2.53it/s]Capturing CUDA graph shapes:  29%|██▊       | 10/35 [00:06<00:09,  2.63it/s]Capturing CUDA graph shapes:  31%|███▏      | 11/35 [00:06<00:08,  2.71it/s]Capturing CUDA graph shapes:  34%|███▍      | 12/35 [00:06<00:08,  2.76it/s]Capturing CUDA graph shapes:  37%|███▋      | 13/35 [00:07<00:07,  2.80it/s]Capturing CUDA graph shapes:  40%|████      | 14/35 [00:07<00:07,  2.82it/s]Capturing CUDA graph shapes:  43%|████▎     | 15/35 [00:07<00:07,  2.85it/s]Capturing CUDA graph shapes:  46%|████▌     | 16/35 [00:08<00:06,  2.86it/s]Capturing CUDA graph shapes:  49%|████▊     | 17/35 [00:08<00:06,  2.87it/s]Capturing CUDA graph shapes:  51%|█████▏    | 18/35 [00:09<00:05,  2.88it/s]Capturing CUDA graph shapes:  54%|█████▍    | 19/35 [00:09<00:05,  2.88it/s]Capturing CUDA graph shapes:  57%|█████▋    | 20/35 [00:09<00:05,  2.88it/s]Capturing CUDA graph shapes:  60%|██████    | 21/35 [00:10<00:04,  2.87it/s]Capturing CUDA graph shapes:  63%|██████▎   | 22/35 [00:10<00:04,  2.88it/s]Capturing CUDA graph shapes:  66%|██████▌   | 23/35 [00:10<00:04,  2.84it/s]Capturing CUDA graph shapes:  69%|██████▊   | 24/35 [00:11<00:03,  2.86it/s]Capturing CUDA graph shapes:  71%|███████▏  | 25/35 [00:11<00:03,  2.87it/s]Capturing CUDA graph shapes:  74%|███████▍  | 26/35 [00:11<00:03,  2.87it/s]Capturing CUDA graph shapes:  77%|███████▋  | 27/35 [00:12<00:02,  2.87it/s]Capturing CUDA graph shapes:  80%|████████  | 28/35 [00:12<00:02,  2.88it/s]Capturing CUDA graph shapes:  83%|████████▎ | 29/35 [00:12<00:02,  2.89it/s]Capturing CUDA graph shapes:  86%|████████▌ | 30/35 [00:13<00:01,  2.89it/s]Capturing CUDA graph shapes:  89%|████████▊ | 31/35 [00:13<00:01,  2.87it/s]Capturing CUDA graph shapes:  91%|█████████▏| 32/35 [00:13<00:01,  2.76it/s]Capturing CUDA graph shapes:  94%|█████████▍| 33/35 [00:14<00:00,  2.73it/s]Capturing CUDA graph shapes:  97%|█████████▋| 34/35 [00:14<00:00,  2.77it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:15<00:00,  2.65it/s]Capturing CUDA graph shapes: 100%|██████████| 35/35 [00:15<00:00,  2.32it/s]
INFO 02-24 11:27:43 model_runner.py:1562] Graph capturing finished in 15 secs, took 0.14 GiB
INFO 02-24 11:27:43 llm_engine.py:431] init engine (profile, create kv cache, warmup model) took 21.44 seconds
INFO 02-24 11:27:44 api_server.py:756] Using supplied chat template:
INFO 02-24 11:27:44 api_server.py:756] None
INFO 02-24 11:27:44 serving_chat.py:108] Overwriting default chat sampling param with: {'temperature': 0.6, 'top_k': 100, 'top_p': 0.95}
INFO 02-24 11:27:44 serving_completion.py:56] Overwriting default completion sampling param with: {'temperature': 0.6, 'top_k': 100, 'top_p': 0.95}
INFO 02-24 11:27:44 launcher.py:21] Available routes are:
INFO 02-24 11:27:44 launcher.py:29] Route: /openapi.json, Methods: HEAD, GET
INFO 02-24 11:27:44 launcher.py:29] Route: /docs, Methods: HEAD, GET
INFO 02-24 11:27:44 launcher.py:29] Route: /docs/oauth2-redirect, Methods: HEAD, GET
INFO 02-24 11:27:44 launcher.py:29] Route: /redoc, Methods: HEAD, GET
INFO 02-24 11:27:44 launcher.py:29] Route: /health, Methods: GET
INFO 02-24 11:27:44 launcher.py:29] Route: /ping, Methods: POST, GET
INFO 02-24 11:27:44 launcher.py:29] Route: /tokenize, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /detokenize, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /v1/models, Methods: GET
INFO 02-24 11:27:44 launcher.py:29] Route: /version, Methods: GET
INFO 02-24 11:27:44 launcher.py:29] Route: /v1/chat/completions, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /v1/completions, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /v1/embeddings, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /pooling, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /score, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /v1/score, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /rerank, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /v1/rerank, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /v2/rerank, Methods: POST
INFO 02-24 11:27:44 launcher.py:29] Route: /invocations, Methods: POST
INFO:     Started server process [4175367]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:11434 (Press CTRL+C to quit)
INFO:     127.0.0.1:38304 - "POST /v1/embeddings HTTP/1.1" 200 OK
slurmstepd: error: *** JOB 62479402 ON della-l06g12 CANCELLED AT 2025-02-24T11:32:00 ***
